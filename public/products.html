<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Les Saboteurs - RORONOA GAMES</title>
  <link rel="stylesheet" href="roronoa-games.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Navigation -->
  <nav class="navbar">
    <div class="container">
      <div class="nav-brand">
        <h1 class="logo">RORONOA <span class="logo-accent">GAMES</span></h1>
        <div class="logo-subtitle">ä¸‰åˆ€æµ â€¢ SantÅryÅ« Style</div>
      </div>
      <div class="nav-links">
        <a href="index-site.html#accueil">Accueil</a>
        <a href="index-site.html#a-propos">Ã€ Propos</a>
        <a href="products.html" class="active">Produits</a>
        <a href="index-site.html#contact">Contact</a>
        <button class="btn-login" onclick="openLoginModal()">Se Connecter</button>
      </div>
      <div class="nav-mobile-toggle" onclick="toggleMobileMenu()">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </nav>

  <!-- Product Hero -->
  <section class="product-hero">
    <div class="container">
      <div class="product-hero-content">
        <div class="product-badge">Notre Jeu Phare</div>
        <h1 class="product-title">LES SABOTEURS</h1>
        <p class="product-tagline">Infiltration â€¢ DÃ©duction â€¢ Multijoueur</p>
        
        <div class="product-cta">
          <a href="https://saboteurs.roronoa-games.com" class="btn btn-primary btn-large">
            ğŸ® Jouer Maintenant
          </a>
          <button class="btn btn-outline btn-large" onclick="openPacksModal()">
            ğŸ’ DÃ©couvrir les Packs
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- Game Description -->
  <section class="game-desc">
    <div class="container">
      <div class="desc-content">
        <h2>Le Jeu</h2>
        <p>
          <strong>Les Saboteurs</strong> est un jeu de dÃ©duction sociale multijoueur qui plonge 
          les joueurs dans une station spatiale en perdition. Certains sont des astronautes 
          innocents cherchant Ã  survivre, d'autres sont des saboteurs infiltrÃ©s dÃ©terminÃ©s 
          Ã  saboter la mission.
        </p>
        <p>
          InspirÃ© des meilleurs jeux sociaux, Les Saboteurs offre une expÃ©rience unique avec 
          vidÃ©o intÃ©grÃ©e, multiples univers thÃ©matiques, et un systÃ¨me de progression addictif.
        </p>
        
        <div class="desc-features">
          <div class="feature-box">
            <div class="feature-icon">ğŸ‘¥</div>
            <h3>4-20 Joueurs</h3>
            <p>Parties intenses en temps rÃ©el</p>
          </div>
          
          <div class="feature-box">
            <div class="feature-icon">ğŸ­</div>
            <h3>RÃ´les VariÃ©s</h3>
            <p>Astronautes, Saboteurs, RÃ´les spÃ©ciaux</p>
          </div>
          
          <div class="feature-box">
            <div class="feature-icon">â±ï¸</div>
            <h3>15-45 Minutes</h3>
            <p>Parties rapides et dynamiques</p>
          </div>
          
          <div class="feature-box">
            <div class="feature-icon">ğŸŒ</div>
            <h3>7 Langues</h3>
            <p>FR, EN, ES, IT, DE, PT, JA</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Themes Section -->
  <section class="themes">
    <div class="container">
      <div class="section-header">
        <div class="section-badge">Univers</div>
        <h2 class="section-title">4 ThÃ¨mes Immersifs</h2>
      </div>
      
      <div class="themes-grid">
        <!-- Spatial -->
        <div class="theme-card">
          <div class="theme-icon">ğŸš€</div>
          <h3>Infiltration Spatiale</h3>
          <p>
            L'univers classique : une station spatiale, des astronautes, des saboteurs.
            RÃ©parez la station avant qu'il ne soit trop tard !
          </p>
          <div class="theme-features">
            <span>ğŸ”§ TÃ¢ches techniques</span>
            <span>ğŸš¨ Sabotages critiques</span>
            <span>ğŸ“¡ Communications radio</span>
          </div>
        </div>
        
        <!-- Loup-Garou -->
        <div class="theme-card">
          <div class="theme-icon">ğŸº</div>
          <h3>Loup-Garou</h3>
          <p>
            Un village mÃ©diÃ©val hantÃ© par les loups-garous. Villageois contre crÃ©atures 
            de la nuit dans une bataille Ã©pique pour la survie.
          </p>
          <div class="theme-features">
            <span>ğŸŒ™ Cycle jour/nuit</span>
            <span>ğŸ”® Pouvoirs spÃ©ciaux</span>
            <span>ğŸ˜ï¸ Village mystÃ©rieux</span>
          </div>
        </div>
        
        <!-- Sorciers -->
        <div class="theme-card">
          <div class="theme-icon">ğŸ§™</div>
          <h3>AcadÃ©mie des Sorciers</h3>
          <p>
            Une Ã©cole de magie infiltrÃ©e par des sorciers noirs. MaÃ®trisez la magie 
            et dÃ©masquez les traÃ®tres avant qu'ils ne corrompent l'acadÃ©mie.
          </p>
          <div class="theme-features">
            <span>âœ¨ Sorts magiques</span>
            <span>ğŸ“š BibliothÃ¨que ancienne</span>
            <span>ğŸ“ Salles de classe</span>
          </div>
        </div>
        
        <!-- Mythique -->
        <div class="theme-card">
          <div class="theme-icon">âš”ï¸</div>
          <h3>Royaumes Mythiques</h3>
          <p>
            Un royaume fantasy menacÃ© par des crÃ©atures corrompues. Chevaliers, 
            mages et traÃ®tres s'affrontent pour le contrÃ´le du royaume.
          </p>
          <div class="theme-features">
            <span>ğŸ° ChÃ¢teau royal</span>
            <span>ğŸ—¡ï¸ Armes lÃ©gendaires</span>
            <span>ğŸ‰ CrÃ©atures mythiques</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Pricing -->
  <section class="pricing">
    <div class="container">
      <div class="section-header">
        <div class="section-badge">Nos Offres</div>
        <h2 class="section-title">Plans Tarifaires</h2>
      </div>
      
      <div class="pricing-grid">
        <!-- Free -->
        <div class="pricing-card">
          <div class="pricing-header">
            <h3>Gratuit</h3>
            <div class="price">
              <span class="currency">0â‚¬</span>
              <span class="period">/mois</span>
            </div>
          </div>
          <ul class="pricing-features">
            <li>âœ… Parties illimitÃ©es</li>
            <li>âœ… 2 avatars IA/mois</li>
            <li>âœ… 2 parties vidÃ©o/mois</li>
            <li>âœ… Tous les thÃ¨mes</li>
            <li>âœ… Mode hors ligne</li>
          </ul>
          <a href="/index.html" class="btn btn-outline">
            Commencer Gratuitement
          </a>
        </div>
        
        <!-- Pack -->
        <div class="pricing-card">
          <div class="pricing-header">
            <h3>Pack 50+50</h3>
            <div class="price">
              <span class="currency">4,99â‚¬</span>
              <span class="period">unique</span>
            </div>
          </div>
          <ul class="pricing-features">
            <li>âœ… 50 avatars IA</li>
            <li>âœ… 50 crÃ©dits vidÃ©o</li>
            <li>âœ… Valables 12 mois</li>
            <li>âœ… Tous les avantages Free</li>
            <li>âœ… Support prioritaire</li>
          </ul>
          <button class="btn btn-secondary" onclick="openLoginModal()">
            Acheter le Pack
          </button>
        </div>
        
        <!-- Premium -->
        <div class="pricing-card featured">
          <div class="pricing-badge">Le Plus Populaire</div>
          <div class="pricing-header">
            <h3>Premium</h3>
            <div class="price">
              <span class="currency">9,99â‚¬</span>
              <span class="period">/mois</span>
            </div>
          </div>
          <ul class="pricing-features">
            <li>âœ… Avatars IA illimitÃ©s</li>
            <li>âœ… Parties vidÃ©o illimitÃ©es</li>
            <li>âœ… Badge exclusif</li>
            <li>âœ… AccÃ¨s anticipÃ© nouveautÃ©s</li>
            <li>âœ… Support VIP 24/7</li>
          </ul>
          <button class="btn btn-primary" onclick="openLoginModal()">
            Devenir Premium
          </button>
        </div>
        
        <!-- Family -->
        <div class="pricing-card">
          <div class="pricing-header">
            <h3>Pack Famille</h3>
            <div class="price">
              <span class="currency">39,99â‚¬</span>
              <span class="period">/mois</span>
            </div>
          </div>
          <ul class="pricing-features">
            <li>âœ… Jusqu'Ã  9 comptes</li>
            <li>âœ… Avantages Premium pour tous</li>
            <li>âœ… Gestion centralisÃ©e</li>
            <li>âœ… Ã‰conomie de 60%</li>
            <li>âœ… Support prioritaire</li>
          </ul>
          <button class="btn btn-outline" onclick="openLoginModal()">
            Pack Famille
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- CTA -->
  <section class="cta">
    <div class="container">
      <div class="cta-content">
        <h2>PrÃªt Ã  Jouer ?</h2>
        <p>Rejoignez des milliers de joueurs dans l'aventure la plus intense !</p>
        <div class="cta-buttons">
          <a href="https://saboteurs.roronoa-games.com" class="btn btn-primary btn-large">
            ğŸ® Jouer Maintenant
          </a>
          <button class="btn btn-outline btn-large" onclick="openLoginModal()">
            ğŸ’ Voir les Offres Premium
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-brand">
          <h3>RORONOA <span>GAMES</span></h3>
          <p>CrÃ©ateur d'expÃ©riences vidÃ©oludiques</p>
        </div>
        <div class="footer-links">
          <div class="footer-column">
            <h4>Navigation</h4>
            <a href="index-site.html#accueil">Accueil</a>
            <a href="index-site.html#a-propos">Ã€ Propos</a>
            <a href="products.html">Produits</a>
            <a href="index-site.html#contact">Contact</a>
          </div>
          <div class="footer-column">
            <h4>LÃ©gal</h4>
            <a href="#">Mentions LÃ©gales</a>
            <a href="#">CGU</a>
            <a href="#">Politique de ConfidentialitÃ©</a>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2026 RORONOA GAMES. Tous droits rÃ©servÃ©s.</p>
      </div>
    </div>
  </footer>

  <!-- Modal Login (mÃªme que index-site.html) -->
  <div id="modal-login" class="modal" style="display: none;">
    <div class="modal-overlay" onclick="closeLoginModal()"></div>
    <div class="modal-content">
      <button class="modal-close" onclick="closeLoginModal()">Ã—</button>
      
      <div class="modal-header">
        <h2>Connexion</h2>
        <p>AccÃ©dez Ã  votre compte RORONOA GAMES</p>
      </div>
      
      <div class="auth-tabs">
        <button class="auth-tab active" onclick="switchAuthTab('login')">Connexion</button>
        <button class="auth-tab" onclick="switchAuthTab('register')">Inscription</button>
      </div>
      
      <form id="login-form" class="auth-form" onsubmit="handleLogin(event)">
        <input type="email" name="email" placeholder="Email" required>
        <input type="password" name="password" placeholder="Mot de passe" required>
        <button type="submit" class="btn btn-primary">Se Connecter</button>
      </form>
      
      <form id="register-form" class="auth-form" style="display: none;" onsubmit="handleRegister(event)">
        <input type="text" name="username" placeholder="Pseudo" required>
        <input type="email" name="email" placeholder="Email" required>
        <input type="password" name="password" placeholder="Mot de passe" required>
        <input type="password" name="confirm_password" placeholder="Confirmer mot de passe" required>
        <button type="submit" class="btn btn-primary">S'Inscrire</button>
      </form>
    </div>
  </div>

  <script src="roronoa-games.js"></script>
\n\n<!-- ============================================================================
   MODAL PACKS - Ã€ AJOUTER DANS index-site.html AVANT <!-- ğŸ” Auth Check Script - VÃ©rifie connexion avant paiements -->
<script src="/js/auth-check.js"></script>

</body>
   ============================================================================ -->

<!-- ============================================================================
   MODAL PACKS V2 - CORRIGÃ‰ - Ã€ AJOUTER DANS index-site.html AVANT <!-- ğŸ” Auth Check Script - VÃ©rifie connexion avant paiements -->
<script src="/js/auth-check.js"></script>

</body>
   ============================================================================ -->

<!-- Modal Packs Premium -->
<div id="modal-packs" class="modal" style="display: none;">
  <div class="modal-overlay" onclick="closePacksModal()"></div>
  <div class="modal-content" style="max-width: 1100px; max-height: 90vh; overflow-y: auto;">
    <button class="modal-close" onclick="closePacksModal()">Ã—</button>
    
    <div class="modal-header" style="text-align: center;">
      <h2 style="color: var(--green-bright); margin: 0;">ğŸ’ Nos Packs Premium</h2>
      <p style="color: #aaa; margin-top: 10px;">Compte vÃ©rifiÃ© requis pour accÃ©der aux packs</p>
    </div>
    
    <div class="packs-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 30px; margin-top: 40px; padding: 0 20px;">
      
      <!-- Pack 50+50 -->
      <div class="pack-card" style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border: 2px solid var(--green-main); border-radius: 15px; padding: 30px; position: relative; overflow: hidden; display: flex; flex-direction: column; align-items: center; text-align: center;">
        <div class="pack-badge" style="position: absolute; top: 15px; right: 15px; background: var(--green-bright); color: #000; padding: 5px 15px; border-radius: 20px; font-size: 12px; font-weight: bold;">
          PONCTUEL
        </div>
        
        <div class="pack-icon" style="font-size: 56px; margin-bottom: 20px;">ğŸ®</div>
        <h3 style="color: var(--green-bright); margin: 0 0 15px 0; font-size: 24px;">Pack 50+50</h3>
        
        <div class="pack-price" style="font-size: 42px; font-weight: bold; color: #fff; margin: 20px 0;">
          4,99â‚¬
          <span style="font-size: 16px; color: #aaa; font-weight: normal; display: block; margin-top: 5px;">une fois</span>
        </div>
        
        <ul style="list-style: none; padding: 0; margin: 25px 0; color: #ccc; line-height: 2; text-align: left; width: 100%;">
          <li style="padding: 5px 0;">âœ… 50 crÃ©dits vidÃ©o</li>
          <li style="padding: 5px 0;">âœ… 50 avatars IA</li>
          <li style="padding: 5px 0;">âœ… Valables 12 mois</li>
          <li style="padding: 5px 0;">âœ… Tous les thÃ¨mes</li>
          <li style="padding: 5px 0;">âœ… Support prioritaire</li>
        </ul>
        
        <button class="btn btn-primary" onclick="buyPack('pack50')" style="width: 100%; margin-top: auto; padding: 15px; font-size: 16px; font-weight: bold; background: var(--green-main); color: #fff; border: none; border-radius: 8px; cursor: pointer; transition: all 0.3s ease;">
          ğŸ›’ Acheter maintenant
        </button>
      </div>
      
      <!-- Premium -->
      <div class="pack-card" style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border: 3px solid var(--green-bright); border-radius: 15px; padding: 30px; position: relative; overflow: hidden; box-shadow: 0 0 30px rgba(107, 157, 58, 0.3); display: flex; flex-direction: column; align-items: center; text-align: center;">
        <div class="pack-badge" style="position: absolute; top: 15px; right: 15px; background: gold; color: #000; padding: 5px 15px; border-radius: 20px; font-size: 12px; font-weight: bold;">
          â­ POPULAIRE
        </div>
        
        <div class="pack-icon" style="font-size: 56px; margin-bottom: 20px;">ğŸŒŸ</div>
        <h3 style="color: var(--green-bright); margin: 0 0 15px 0; font-size: 24px;">Premium</h3>
        
        <div class="pack-price" style="font-size: 42px; font-weight: bold; color: #fff; margin: 20px 0;">
          1,49â‚¬
          <span style="font-size: 16px; color: #aaa; font-weight: normal; display: block; margin-top: 5px;">/mois</span>
        </div>
        
        <ul style="list-style: none; padding: 0; margin: 25px 0; color: #ccc; line-height: 2; text-align: left; width: 100%;">
          <li style="padding: 5px 0;">âœ… Visio illimitÃ©e</li>
          <li style="padding: 5px 0;">âœ… 30 avatars IA/mois</li>
          <li style="padding: 5px 0;">âœ… 4 thÃ¨mes complets</li>
          <li style="padding: 5px 0;">âœ… Badge exclusif</li>
          <li style="padding: 5px 0;">âœ… Support VIP 24/7</li>
          <li style="padding: 5px 0;">âœ… AccÃ¨s anticipÃ© nouveautÃ©s</li>
        </ul>
        
        <button class="btn btn-primary" onclick="buyPack('premium')" style="width: 100%; margin-top: auto; padding: 15px; font-size: 16px; font-weight: bold; background: var(--green-bright); color: #fff; border: none; border-radius: 8px; cursor: pointer; transition: all 0.3s ease;">
          ğŸš€ S'abonner
        </button>
      </div>
      
      <!-- Pack Famille -->
      <div class="pack-card" style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border: 2px solid var(--green-main); border-radius: 15px; padding: 30px; position: relative; overflow: hidden; display: flex; flex-direction: column; align-items: center; text-align: center;">
        <div class="pack-badge" style="position: absolute; top: 15px; right: 15px; background: #ff6b6b; color: #fff; padding: 5px 15px; border-radius: 20px; font-size: 12px; font-weight: bold;">
          FAMILLE
        </div>
        
        <div class="pack-icon" style="font-size: 56px; margin-bottom: 20px;">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</div>
        <h3 style="color: var(--green-bright); margin: 0 0 15px 0; font-size: 24px;">Pack Famille</h3>
        
        <div class="pack-price" style="font-size: 42px; font-weight: bold; color: #fff; margin: 20px 0;">
          9,99â‚¬
          <span style="font-size: 16px; color: #aaa; font-weight: normal; display: block; margin-top: 5px;">/mois</span>
        </div>
        
        <ul style="list-style: none; padding: 0; margin: 25px 0; color: #ccc; line-height: 2; text-align: left; width: 100%;">
          <li style="padding: 5px 0;">âœ… Jusqu'Ã  9 comptes</li>
          <li style="padding: 5px 0;">âœ… Visio illimitÃ©e pour tous</li>
          <li style="padding: 5px 0;">âœ… 30 avatars/mois par utilisateur</li>
          <li style="padding: 5px 0;">âœ… 4 thÃ¨mes complets</li>
          <li style="padding: 5px 0;">âœ… Gestion centralisÃ©e</li>
          <li style="padding: 5px 0;">âœ… Ã‰conomie de 85%</li>
        </ul>
        
        <button class="btn btn-primary" onclick="buyPack('family')" style="width: 100%; margin-top: auto; padding: 15px; font-size: 16px; font-weight: bold; background: var(--green-main); color: #fff; border: none; border-radius: 8px; cursor: pointer; transition: all 0.3s ease;">
          ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ S'abonner en famille
        </button>
      </div>
      
    </div>
    
    <div class="modal-footer" style="margin-top: 40px; padding: 25px 20px; border-top: 1px solid #333; text-align: center; color: #aaa;">
      <p style="margin: 0; font-size: 16px;">
        ğŸ’¡ <strong>Compte vÃ©rifiÃ© requis</strong> pour accÃ©der aux packs. 
        <a href="#" onclick="closePacksModal(); openLoginModal(); return false;" style="color: var(--green-bright); text-decoration: none;">Se connecter</a> ou 
        <a href="#" onclick="closePacksModal(); openLoginModal(); return false;" style="color: var(--green-bright); text-decoration: none;">crÃ©er un compte</a>.
      </p>
      <p style="margin-top: 20px; font-size: 14px; color: #888;">
        ğŸ”’ Paiement sÃ©curisÃ© via Stripe â€¢ ğŸ’³ CB, Apple Pay, Google Pay acceptÃ©s â€¢ ğŸ”„ Annulation Ã  tout moment
      </p>
    </div>
  </div>
</div>

<style>
/* Styles pour le modal packs V2 */
.packs-grid {
  animation: fadeInUp 0.5s ease;
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.pack-card {
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  min-height: 550px;
}

.pack-card:hover {
  transform: translateY(-10px);
  box-shadow: 0 15px 40px rgba(107, 157, 58, 0.3);
}

.pack-card .btn {
  transition: all 0.3s ease;
}

.pack-card .btn:hover {
  transform: scale(1.05);
  box-shadow: 0 8px 20px rgba(107, 157, 58, 0.5);
  filter: brightness(1.1);
}

/* Responsive */
@media (max-width: 768px) {
  .packs-grid {
    grid-template-columns: 1fr !important;
    gap: 20px !important;
  }
  
  .modal-content {
    max-width: 95% !important;
    margin: 20px auto !important;
  }
  
  .pack-card {
    min-height: auto;
  }
}
</style>

<script>
// ============================================================================
// FONCTIONS MODAL PACKS V2
// ============================================================================

function openPacksModal() {
  document.getElementById('modal-packs').style.display = 'flex';
  document.body.style.overflow = 'hidden'; // EmpÃªcher scroll
}

function closePacksModal() {
  document.getElementById('modal-packs').style.display = 'none';
  document.body.style.overflow = 'auto'; // RÃ©activer scroll
}

// Fonction d'achat de pack
async function buyPack(packType) {
  // VÃ©rifier si l'utilisateur est connectÃ©
  const token = localStorage.getItem('token') || localStorage.getItem('saboteur_token');
  
  if (!token) {
    // Pas connectÃ© â†’ Ouvrir le modal de connexion
    closePacksModal();
    if (typeof openLoginModal === 'function') {
      openLoginModal();
    } else {
      alert('âš ï¸ Vous devez Ãªtre connectÃ© pour acheter un pack.\n\nCrÃ©ez un compte ou connectez-vous pour continuer.');
    }
    return;
  }
  
  // VÃ©rifier si l'utilisateur a vÃ©rifiÃ© son email
  try {
    const response = await fetch('/api/auth/me', {
      headers: {
        'Authorization': `Bearer ${token}`
      }
    });
    
    if (!response.ok) {
      throw new Error('Non authentifiÃ©');
    }
    
    const user = await response.json();
    
    if (!user.emailVerified) {
      alert('âš ï¸ Veuillez vÃ©rifier votre email avant d\'acheter un pack.\n\nUn email de vÃ©rification vous a Ã©tÃ© envoyÃ© lors de votre inscription.\n\nVÃ©rifiez votre boÃ®te de rÃ©ception et vos spams.');
      return;
    }
    
    // Afficher un loader
    const button = event.target;
    const originalText = button.innerHTML;
    button.innerHTML = 'â³ Chargement...';
    button.disabled = true;
    
    // Rediriger vers Stripe selon le type de pack
    let checkoutUrl;
    
    switch(packType) {
      case 'pack50':
        checkoutUrl = '/api/stripe/create-checkout-session?pack=50';
        break;
      case 'premium':
        checkoutUrl = '/api/stripe/create-checkout-session?subscription=premium';
        break;
      case 'family':
        checkoutUrl = '/api/stripe/create-checkout-session?subscription=family';
        break;
      default:
        button.innerHTML = originalText;
        button.disabled = false;
        alert('Pack inconnu');
        return;
    }
    
    // CrÃ©er la session Stripe
    const checkoutResponse = await fetch(checkoutUrl, {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${token}`,
        'Content-Type': 'application/json'
      }
    });
    
    if (!checkoutResponse.ok) {
      throw new Error('Erreur lors de la crÃ©ation de la session de paiement');
    }
    
    const { url } = await checkoutResponse.json();
    
    // Rediriger vers Stripe
    window.location.href = url;
    
  } catch (error) {
    console.error('Erreur:', error);
    alert('âŒ Erreur lors de l\'achat. Veuillez rÃ©essayer ou contacter le support.');
    
    // RÃ©activer le bouton
    if (event && event.target) {
      event.target.innerHTML = originalText;
      event.target.disabled = false;
    }
  }
}

// Fermer le modal si on clique en dehors
document.addEventListener('click', function(e) {
  const modal = document.getElementById('modal-packs');
  if (modal && e.target === modal) {
    closePacksModal();
  }
});

// Fermer avec Ã‰chap
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') {
    const modal = document.getElementById('modal-packs');
    if (modal && modal.style.display === 'flex') {
      closePacksModal();
    }
  }
});
</script>

\n\n<!-- ğŸ” Auth Check Script - VÃ©rifie connexion avant paiements -->
<script src="/js/auth-check.js"></script>

</body>
</html>
