<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ğŸ­ LES SABOTEURS ğŸ­</title>
  <!-- Polices pour thÃ¨me Default (Spatial) -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;600;700&display=swap" rel="stylesheet">
  
  <!-- Polices pour thÃ¨me Werewolf (Village) -->
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700;900&family=Crimson+Text:wght@400;600;700&display=swap" rel="stylesheet">
  
  <!-- Polices pour thÃ¨me Wizard Academy (AcadÃ©mie) -->
  <link href="https://fonts.googleapis.com/css2?family=Philosopher:wght@400;700&family=Cormorant+Garamond:wght@400;600;700&display=swap" rel="stylesheet">
  
  <!-- Polices pour thÃ¨me Mythic Realms (Royaume) -->
  <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&family=Uncial+Antiqua:wght@700&family=Lora:wght@400;600;700&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <!-- Bouton RÃˆGLES Ã  gauche -->
  <div id="topLeftButtons" style="
    position: fixed; left: 20px; top: 20px; z-index: 9999;
  ">
    <button id="rulesBtn" class="btn btn-secondary" style="
      padding: 10px 16px; border-radius: 10px; font-weight: 800;
    ">ğŸ“œ <span class="rulesBtnText">RÃˆGLES</span></button>
  </div>
  
  <!-- Bouton MUTE Ã  droite -->
  <div id="topRightButtons" style="
    position: fixed; right: 20px; top: 20px; z-index: 9999;
  ">
    <button id="soundBtn" class="btn btn-secondary" style="
      padding: 10px 16px; border-radius: 10px; font-weight: 900;
      min-width: 56px;
    " title="Couper / rÃ©activer le son">ğŸ”Š</button>
  </div>

  <div class="container">
    <!-- Audio Unlock Overlay -->
    <div id="audioUnlockOverlay" style="
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      z-index: 99999;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      gap: 20px;
    ">
      <div style="font-size: 4rem; animation: pulse 1.5s infinite;">ğŸ”Š</div>
      <div style="font-size: 1.5rem; color: var(--neon-cyan); font-weight: 800; text-align: center;">
        CLIQUEZ POUR ACTIVER LE SON
      </div>
      <button id="audioUnlockBtn" class="btn btn-primary" style="
        padding: 20px 40px;
        font-size: 1.3rem;
        font-weight: 900;
        animation: glow 1.5s infinite;
      ">ğŸµ ACTIVER L'AUDIO</button>
    </div>
    
    <div class="header">
      <div class="logo"></div>
      <h1 id="mainTitle">INFILTRATION SPATIALE</h1>
      <div class="subtitle">âš¡ MISSION TEMPS RÃ‰EL âš¡</div>
      <div id="buildBadge" style="margin-top:10px; opacity:.85; font-size:.95rem;"></div>
      <div id="topBanner" style="display:none; margin-top:12px; color: var(--neon-orange); font-weight:700; letter-spacing:1px;"></div>
    </div>

    <!-- HOME -->
    <div id="homeScreen" class="screen active">
      <div style="width: 100%; max-width: 800px; margin: 0 auto;
          background: linear-gradient(135deg, #0a0e27 0%, #1a1e3f 50%, #0a0e27 100%);
          border: 3px solid var(--metal-grey); border-radius: 20px; padding: 40px;
          box-shadow: 0 0 60px rgba(0,255,255,0.3), inset 0 0 100px rgba(0,0,0,0.5);">
        
        <!-- Titre Principal -->
        <div style="text-align: center; margin-bottom: 40px;">
          <h1 style="color: var(--neon-cyan); font-size: clamp(2rem, 6vw, 3rem); margin: 0; 
              text-shadow: 0 0 30px var(--neon-cyan); letter-spacing: 3px;">
            LES SABOTEURS
          </h1>
          <p style="color: var(--neon-green); margin-top: 10px; font-size: 1rem; opacity: 0.8;">
            Jeu de dÃ©duction sociale multijoueur
          </p>
        </div>

        <!-- SÃ©lecteur de ThÃ¨me -->
        <div style="margin-bottom: 30px; padding: 20px; border-radius: 12px; 
            border: 2px solid rgba(0, 255, 255, 0.3); background: rgba(0, 0, 0, 0.4);">
          <div style="text-align: center; margin-bottom: 15px;">
            <span style="color: var(--neon-cyan); font-weight: 700; font-size: 1.1rem;">
              ğŸ¨ CHOIX DU THÃˆME
            </span>
          </div>
          <div id="homeThemeSelector" style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;">
            <!-- Les boutons seront gÃ©nÃ©rÃ©s par JS -->
          </div>
          <div id="homeThemeDescription" style="text-align: center; margin-top: 15px; 
              color: rgba(255, 255, 255, 0.7); font-size: 0.9rem; min-height: 24px;">
          </div>
        </div>

        <!-- Formulaire -->
        <div style="padding: 20px; border-radius: 12px; 
            border: 2px solid var(--neon-cyan); background: rgba(0, 255, 255, 0.05);">
          <div class="form-group" style="margin-bottom: 20px;">
            <label for="playerName" style="color: var(--neon-cyan); font-weight: 700; margin-bottom: 8px; display: block;">
              NOM DU JOUEUR
            </label>
            <input type="text" id="playerName" placeholder="Entrez votre nom" maxlength="20"
                style="width: 100%; padding: 12px; font-size: 1rem; border-radius: 8px;
                background: rgba(0, 0, 0, 0.6); border: 2px solid rgba(0, 255, 255, 0.3);
                color: white; outline: none; transition: all 0.3s;">
          </div>
          <div class="btn-group" style="display: flex; gap: 10px; flex-direction: column;">
            <button class="btn btn-primary" id="createBtn" style="padding: 15px; font-size: 1.1rem;">
              ğŸš€ CRÃ‰ER UNE MISSION
            </button>
            <button class="btn btn-secondary" id="joinBtn" style="padding: 15px; font-size: 1.1rem;">
              ğŸ”— REJOINDRE UNE MISSION
            </button>
          </div>
        </div>

      </div>
    </div>

    <!-- CREATE -->
    <div id="createScreen" class="screen">
      <div class="control-panel">
        <h2 class="panel-title" id="createMissionTitle">CRÃ‰ER UNE MISSION</h2>
        <div class="btn-group">
          <button class="btn btn-primary" id="createRoomBtn">GÃ©nÃ©rer Code Mission</button>
          <button class="btn btn-secondary" id="backFromCreate">Retour</button>
        </div>
      </div>
    </div>

    <!-- JOIN -->
    <div id="joinScreen" class="screen">
      <div class="control-panel">
        <h2 class="panel-title" id="joinMissionTitle">REJOINDRE UNE MISSION</h2>
        <div class="form-group">
          <label for="joinRoomCode">NumÃ©ro de salle</label>
          <input type="text" id="joinRoomCode" placeholder="0000" maxlength="4">
        </div>
        <div class="btn-group">
          <button class="btn btn-primary" id="joinRoomBtn">Connexion</button>
          <button class="btn btn-secondary" id="backFromJoin">Retour</button>
        </div>
      </div>
    </div>

    <!-- LOBBY (cockpit style) -->
    <div id="lobbyScreen" class="screen">
      <div style="width: 100%; max-width: 1200px; margin: 0 auto;
          background: linear-gradient(135deg, #0a0e27 0%, #1a1e3f 50%, #0a0e27 100%);
          border: 3px solid var(--metal-grey); border-radius: 20px; padding: 40px;
          box-shadow: 0 0 60px rgba(0,255,255,0.3), inset 0 0 100px rgba(0,0,0,0.5);">

        <div style="text-align: center; margin-bottom: 40px; position: relative; display:flex; flex-direction:column; align-items:center;">
          <div style="position: absolute; top: 0; left: 50%; transform: translateX(-50%);
              width: min(380px, 86vw); height: 62px; background: rgba(0,255,255,0.1);
              border: 2px solid var(--neon-cyan); border-radius: 10px;"></div>
	          <h1 class="lobby-title-text" style="display:flex; align-items:center; justify-content:center;
              color: var(--neon-cyan); font-size: clamp(1.3rem, 5vw, 1.9rem);
              margin: 0; padding: 0 10px; height: 62px; box-sizing: border-box;
	              white-space: nowrap; line-height: 62px; letter-spacing: 2px;
              max-width: min(380px, 86vw); overflow: hidden; text-overflow: ellipsis;
              text-shadow: 0 0 30px var(--neon-cyan); position: relative; text-align:center;">
            LES SABOTEURS
          </h1>
        </div>

        <div style="display:flex; justify-content:space-between; gap:18px; flex-wrap:wrap;">
          <div>
            <div style="color: var(--neon-orange); font-size: 1rem; margin-bottom: 5px;">CODE MISSION</div>
            <div id="displayRoomCode" style="color: var(--neon-cyan); font-size: 2.5rem;
                font-weight: bold; text-shadow: 0 0 20px var(--neon-cyan);">0000</div>
          </div>
          <div style="display:flex; gap:12px; align-items:center; flex-wrap:wrap;">
            <button class="btn btn-secondary" id="readyBtn">âœ… PRÃŠT</button>
            <button class="btn btn-primary" id="startGameBtn" style="display:none;">ğŸš€ Lancer Mission</button>
          </div>
        </div>

        <div style="text-align: center; margin: 40px 0;">
          <div id="playerCount" style="font-size: 7rem; color: var(--neon-cyan);
              text-shadow: 0 0 80px var(--neon-cyan); font-weight: 900;
              font-family: 'Orbitron', sans-serif;">0</div>
          <div style="color: var(--metal-grey); font-size: 1.1rem; margin-top: -10px;">MEMBRES D'Ã‰QUIPAGE</div>
        </div>

        <div style="margin: 25px 0;">
          <div style="position: relative; height: 50px;
              background: linear-gradient(to right, var(--neon-cyan) 0%, var(--neon-cyan) 50%, var(--neon-red) 50%, var(--neon-red) 100%);
              border-radius: 25px; overflow: hidden; border: 3px solid var(--metal-grey);
              box-shadow: 0 0 30px rgba(0,255,255,0.5), inset 0 0 30px rgba(0,0,0,0.8);">
            <div id="balanceIndicatorCockpit" style="position: absolute; top: 50%; left: 50%;
                transform: translate(-50%, -50%); width: 26px; height: 26px;
                background: var(--neon-green); border-radius: 50%;
                box-shadow: 0 0 40px var(--neon-green); border: 3px solid white;
                transition: left 0.3s ease;"></div>
          </div>
	          <div id="balanceLabelsCockpit" style="display:flex; justify-content:space-between; margin-top:12px; padding: 0 10px; gap:12px; flex-wrap:wrap;">
	            <span id="balanceLabelLeft" style="color: var(--neon-cyan); font-size: 1.1rem; font-weight:bold;">ASTRONAUTES</span>
	            <span id="balanceStatusCockpit" style="color: var(--neon-green); font-size: 1.1rem; font-weight:bold; display:none;">MISSION BALANCED</span>
	            <span id="balanceLabelRight" style="color: var(--neon-red); font-size: 1.1rem; font-weight:bold;">SABOTEURS</span>
	          </div>
        </div>

        <!-- Phrase de rÃ©partition simple -->
        <div id="autoAllocation" style="text-align: center; margin: 20px 0 15px 0; 
            color: var(--neon-cyan); font-size: 1.05rem; opacity: 0.9;"></div>

        <!-- Config rÃ´les en pleine largeur -->
        <div style="background: rgba(0,0,0,0.6); padding: 20px; border-radius: 15px;
            border: 2px solid var(--neon-orange); box-shadow: 0 0 20px rgba(255,165,0,0.3);">
          <h3 style="color: var(--neon-orange); margin:0 0 12px 0; font-size:1.2rem; text-align:center;">CONFIG RÃ”LES (HÃ”TE)</h3>
          <div id="rolesConfig"></div>
        </div>

        <!-- SÃ©lection de thÃ¨me (hÃ´te uniquement) -->
        <div id="themeSelector" style="display:none; margin-top: 20px; background: rgba(0,0,0,0.6); padding: 20px; border-radius: 15px;
            border: 2px solid var(--neon-purple, #9d4edd); box-shadow: 0 0 20px rgba(157,78,221,0.3);">
          <h3 style="color: var(--neon-purple, #9d4edd); margin:0 0 12px 0; font-size:1.2rem; text-align:center;">ğŸ¨ THÃˆME (HÃ”TE)</h3>
          <div id="themeButtons" style="display: flex; gap: 12px; flex-wrap: wrap; justify-content: center;"></div>
          <div id="themeDescription" style="margin-top: 15px; padding: 12px; background: rgba(0,0,0,0.4); border-radius: 8px; color: #ccc; font-size: 0.95rem; text-align: center; min-height: 40px;"></div>
        </div>
      </div>

      <div class="control-panel" style="margin-top: 20px;">
        <h2 class="panel-title" id="connectedPlayersTitle">Ã‰QUIPAGE CONNECTÃ‰</h2>
        <div class="players-list" id="playersList"></div>
      </div>
    </div>

    <!-- GAME -->
    <div id="gameScreen" class="screen">
      <div id="gameBackdrop" style="width:100%; height:180px; border-radius:16px; overflow:hidden; border:2px solid var(--neon-cyan);
        background-size:cover; background-position:center; margin-bottom: 16px; position:relative;">
        <img id="ejectionOverlay" src="/images/default/out.png" alt="ejection" style="display:none; position:absolute; inset:0; width:100%; height:100%; object-fit:cover; opacity:.28; pointer-events:none;">
      </div>
      <div id="deadBanner" style="display:none; margin-bottom: 12px; padding:10px 12px; border-radius:12px; border:2px solid var(--neon-red); color: var(--neon-red); font-weight:900; text-align:center;">ğŸ’€ Vous avez Ã©tÃ© Ã©jectÃ©</div>

      <div class="control-panel" style="max-width: 900px;">
        <div style="display:flex; justify-content:space-between; gap:16px; flex-wrap:wrap; align-items:center;">
          <div>
            <div style="opacity:.85; letter-spacing:2px; font-family:'Orbitron',sans-serif; font-size:.9rem;">MISSION</div>
            <div id="hudRoom" style="font-size:1.6rem; font-weight:900; letter-spacing:3px;"></div>
          </div>
          <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
            <div id="roleIcons" style="display:flex; gap:8px; align-items:center;"></div>
            <div id="linkBanner" style="display:none; padding:6px 10px; border:2px solid var(--neon-orange); border-radius:10px; color:var(--neon-orange); font-weight:800;"></div>
          </div>
        </div>

        <div style="margin-top: 18px;">
          <div id="phaseTitle" class="panel-title" style="margin-bottom:10px;">â€”</div>
          <div id="phaseText" style="font-size:1.1rem; line-height:1.4; opacity:.95;"></div>
          <div id="ackLine" style="margin-top:10px; color: var(--neon-green); font-weight:800;"></div>
        </div>

        <div id="controls" style="margin-top: 18px;"></div>

<!-- ACTIONS DE PHASE (V9.2 â€“ IA EXCHANGE / VALIDATION) -->
<div id="phase-actions" style="margin-top:18px; text-align:center;"></div>
        
        <!-- Panneau de contrÃ´le hÃ´te (force advance) -->
        <div id="hostControls" style="display:none; margin-top: 18px; padding: 15px; background: rgba(255,165,0,0.1); border: 2px solid var(--neon-orange); border-radius: 12px;">
          <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 12px;">
            <div>
              <div style="color: var(--neon-orange); font-weight: 800; font-size: 1.1rem; margin-bottom: 5px;">âš¡ CONTRÃ”LES HÃ”TE</div>
              <div id="phaseTimer" style="color: #ccc; font-size: 0.9rem;">Phase active depuis : <span id="phaseElapsed">0s</span></div>
              <div id="pendingPlayers" style="margin-top: 5px; color: #999; font-size: 0.85rem;"></div>
            </div>
            <button id="forceAdvanceBtn" class="btn" style="background: var(--neon-orange); color: #000; font-weight: 800; padding: 12px 20px; opacity: 0.5; cursor: not-allowed;" disabled>
              â­ï¸ Forcer la suite (20s min)
            </button>
          </div>
        </div>
        
        <div id="log" style="margin-top:16px; max-height:220px; overflow:auto; padding:10px; border-radius:12px;
          background: rgba(0,0,0,0.35); border:1px solid rgba(0,255,255,0.25);"></div>
      </div>
    </div>

    <!-- END -->
    <div id="endScreen" class="screen">
      <div id="endBackdrop" style="width:100%; height:180px; border-radius:16px; overflow:hidden; border:2px solid var(--neon-cyan);
        background-size:cover; background-position:center; margin-bottom: 16px;"></div>
      <div class="control-panel" style="max-width: 900px;">
        <h2 class="panel-title winner-title" id="winnerTitle"></h2>
        <div id="endSummary" style="margin-bottom:16px;"></div>
        
        <!-- Badges dÃ©bloquÃ©s cette partie -->
        <div id="newBadgesSection" style="display:none; margin-bottom: 20px; padding: 20px; background: linear-gradient(135deg, rgba(157,78,221,0.2), rgba(255,165,0,0.2)); border: 2px solid var(--neon-purple, #9d4edd); border-radius: 15px;">
          <h3 style="color: var(--neon-purple, #9d4edd); margin: 0 0 15px 0; text-align: center; font-size: 1.4rem;">ğŸ† BADGES DÃ‰BLOQUÃ‰S</h3>
          <div id="newBadgesList" style="display: flex; flex-wrap: wrap; gap: 12px; justify-content: center;"></div>
        </div>
        
        <div class="ranking-table" id="rankingTable"></div>

        <div class="btn-group" style="margin-top: 18px;">
          <button class="btn btn-primary" id="replayBtn">ğŸ” Rejouer dans cette chambre (garder les stats)</button>
          <button class="btn btn-secondary" id="newGameBtn">ğŸ†• Nouvelle partie (rÃ©initialiser les stats)</button>
        </div>
      </div>
    </div>

    <div id="errorDisplay"></div>
  </div>

  <!-- Rules modal -->
  <div id="rulesModal" style="display:none; position:fixed; inset:0; z-index:10000; background: rgba(0,0,0,0.75);">
    <div style="max-width: 900px; margin: 5vh auto; background: linear-gradient(135deg, var(--dark-panel), #0d1f3a);
      border:2px solid var(--neon-cyan); border-radius: 16px; padding: 18px; position: relative;">
      <button id="rulesClose" class="btn btn-secondary" style="position:absolute; right:12px; top:12px;">âœ–</button>
      <div class="panel-title">RÃˆGLES</div>
      <div id="rulesContent" style="line-height:1.45; font-size:1.05rem; max-height: 75vh; overflow:auto; padding-right:10px;"></div>
      <button id="tutorialBtn" class="btn btn-primary" style="margin-top: 15px; width: 100%;">ğŸ“– Voir le tutoriel rapide</button>
    </div>
  </div>

  <!-- Tutorial modal -->
  <div id="tutorialModal" style="display:none; position:fixed; inset:0; z-index:10001; background: rgba(0,0,0,0.85);">
    <div style="max-width: 700px; margin: 10vh auto; background: linear-gradient(135deg, var(--primary-bg), var(--secondary-bg));
      border:3px solid var(--neon-cyan); border-radius: 20px; padding: 30px; position: relative; box-shadow: 0 0 60px var(--neon-cyan);">
      <button id="tutorialClose" class="btn btn-secondary" style="position:absolute; right:15px; top:15px;">âœ–</button>
      
      <div id="tutorialContent">
        <!-- Ã‰cran 1 -->
        <div class="tutorial-screen" data-screen="1" style="display:block;">
          <div style="text-align:center; margin-bottom: 25px;">
            <div style="font-size: 4rem; margin-bottom: 10px;">ğŸš€</div>
            <h2 style="color: var(--neon-cyan); font-size: 1.8rem; margin: 0;">Bienvenue !</h2>
          </div>
          <p style="font-size: 1.1rem; line-height: 1.6; color: var(--text-primary);">
            <strong>Infiltration Spatiale</strong> est un jeu de dÃ©duction sociale oÃ¹ des <span style="color: var(--neon-red);">saboteurs</span> 
            tentent d'Ã©liminer les <span style="color: var(--neon-cyan);">astronautes</span> sans Ãªtre dÃ©couverts.
          </p>
          <p style="font-size: 1.05rem; line-height: 1.6; color: var(--text-secondary);">
            Le jeu alterne entre <strong>phases de nuit</strong> (actions secrÃ¨tes) et <strong>phases de jour</strong> (discussions et votes).
          </p>
        </div>

        <!-- Ã‰cran 2 -->
        <div class="tutorial-screen" data-screen="2" style="display:none;">
          <div style="text-align:center; margin-bottom: 25px;">
            <div style="font-size: 4rem; margin-bottom: 10px;">ğŸŒ™</div>
            <h2 style="color: var(--neon-purple, var(--neon-cyan)); font-size: 1.8rem; margin: 0;">Phase de nuit</h2>
          </div>
          <ul style="font-size: 1.05rem; line-height: 1.8; color: var(--text-primary); padding-left: 25px;">
            <li><strong style="color: var(--neon-red);">Saboteurs</strong> : choisissent une victime (unanimitÃ© requise)</li>
            <li><strong style="color: var(--neon-cyan);">Officier Radar</strong> : inspecte un joueur (saboteur ou non ?)</li>
            <li><strong style="color: var(--neon-green);">Docteur Bio</strong> : peut sauver OU tuer (1 vie + 1 mort max)</li>
            <li><strong style="color: var(--neon-orange);">RÃ´les spÃ©ciaux</strong> : CamÃ©lÃ©on, Agent IA, etc.</li>
          </ul>
        </div>

        <!-- Ã‰cran 3 -->
        <div class="tutorial-screen" data-screen="3" style="display:none;">
          <div style="text-align:center; margin-bottom: 25px;">
            <div style="font-size: 4rem; margin-bottom: 10px;">â˜€ï¸</div>
            <h2 style="color: var(--neon-orange); font-size: 1.8rem; margin: 0;">Phase de jour</h2>
          </div>
          <ul style="font-size: 1.05rem; line-height: 1.8; color: var(--text-primary); padding-left: 25px;">
            <li>Les rÃ©sultats de la nuit sont rÃ©vÃ©lÃ©s (qui est mort ?)</li>
            <li>Tous les joueurs vivants <strong>discutent</strong> et <strong>dÃ©battent</strong></li>
            <li>Un <strong>vote d'Ã©jection</strong> a lieu pour Ã©liminer un suspect</li>
            <li>Le <strong>Capitaine</strong> tranche en cas d'Ã©galitÃ©</li>
          </ul>
          <p style="margin-top: 15px; padding: 12px; background: rgba(255,165,0,0.15); border-left: 3px solid var(--neon-orange); border-radius: 8px; color: var(--text-secondary);">
            <strong>Astuce :</strong> Observez les comportements, cherchez les contradictions, et faites confiance Ã  votre instinct !
          </p>
        </div>

        <!-- Ã‰cran 4 -->
        <div class="tutorial-screen" data-screen="4" style="display:none;">
          <div style="text-align:center; margin-bottom: 25px;">
            <div style="font-size: 4rem; margin-bottom: 10px;">ğŸ†</div>
            <h2 style="color: var(--neon-green); font-size: 1.8rem; margin: 0;">Conditions de victoire</h2>
          </div>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
            <div style="padding: 15px; background: rgba(0,255,255,0.1); border: 2px solid var(--neon-cyan); border-radius: 12px;">
              <div style="font-size: 2rem; margin-bottom: 8px;">ğŸ‘¨â€ğŸš€</div>
              <div style="color: var(--neon-cyan); font-weight: 800; margin-bottom: 5px;">Astronautes gagnent</div>
              <div style="font-size: 0.95rem; color: var(--text-secondary);">Tous les saboteurs sont Ã©jectÃ©s</div>
            </div>
            <div style="padding: 15px; background: rgba(255,7,58,0.1); border: 2px solid var(--neon-red); border-radius: 12px;">
              <div style="font-size: 2rem; margin-bottom: 8px;">âš”ï¸</div>
              <div style="color: var(--neon-red); font-weight: 800; margin-bottom: 5px;">Saboteurs gagnent</div>
              <div style="font-size: 0.95rem; color: var(--text-secondary);">Nombre de saboteurs â‰¥ astronautes</div>
            </div>
          </div>
          <p style="text-align: center; font-size: 1.1rem; color: var(--neon-green); font-weight: 800;">
            PrÃªt Ã  jouer ? CrÃ©ez ou rejoignez une mission ! ğŸš€
          </p>
        </div>
      </div>

      <!-- Navigation -->
      <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 25px; padding-top: 20px; border-top: 2px solid var(--neon-cyan);">
        <button id="tutorialPrev" class="btn btn-secondary">â† PrÃ©cÃ©dent</button>
        <div style="display: flex; gap: 8px;">
          <div class="tutorial-dot" data-dot="1" style="width: 12px; height: 12px; border-radius: 50%; background: var(--neon-cyan); cursor: pointer;"></div>
          <div class="tutorial-dot" data-dot="2" style="width: 12px; height: 12px; border-radius: 50%; background: var(--neon-cyan); opacity: 0.3; cursor: pointer;"></div>
          <div class="tutorial-dot" data-dot="3" style="width: 12px; height: 12px; border-radius: 50%; background: var(--neon-cyan); opacity: 0.3; cursor: pointer;"></div>
          <div class="tutorial-dot" data-dot="4" style="width: 12px; height: 12px; border-radius: 50%; background: var(--neon-cyan); opacity: 0.3; cursor: pointer;"></div>
        </div>
        <button id="tutorialNext" class="btn btn-primary">Suivant â†’</button>
      </div>

      <div style="text-align: center; margin-top: 15px;">
        <label style="display: inline-flex; align-items: center; gap: 8px; cursor: pointer; color: #ccc; font-size: 0.95rem;">
          <input type="checkbox" id="tutorialDontShow" style="width: 18px; height: 18px; cursor: pointer;">
          <span>Ne plus afficher ce tutoriel</span>
        </label>
      </div>
    </div>
  </div>

  <!-- Boot: ensure Socket.IO client is available (works on Render + local; shows a clear error if server not running) -->
  <script>
    (function () {
      function loadScript(src) {
        return new Promise(function (resolve) {
          var s = document.createElement('script');
          s.src = src;
          s.async = true;
          s.onload = function () { resolve(true); };
          s.onerror = function () { resolve(false); };
          document.head.appendChild(s);
        });
      }

      function loadClient() {
        var s = document.createElement('script');
        s.src = 'client.js';
        s.async = true;
        document.body.appendChild(s);
      }

      function loadVideoManager() {
        // Charger le CSS d'abord
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = 'daily-video.css';
        document.head.appendChild(link);
        
        // Puis le JS
        var s = document.createElement('script');
        s.src = 'daily-video.js';
        s.async = true;
        document.body.appendChild(s);
      }

      function loadVideoIntegration() {
        var s = document.createElement('script');
        s.src = 'video-integration-client.js';
        s.async = true;
        document.body.appendChild(s);
      }

      // Try local first (Render/local). If not available (e.g., opened via file://), fallback to CDN
      loadScript('/socket.io/socket.io.js').then(function () {
        if (typeof window.io === 'undefined') {
          return loadScript('https://cdn.socket.io/4.7.5/socket.io.min.js');
        }
        return true;
      })
      .then(function() {
        // Charger Daily.co
        return loadScript('https://unpkg.com/@daily-co/daily-js@0.60.0/dist/daily-iframe.js');
      })
      .then(function() {
        // Charger le video manager
        loadVideoManager();
        // Charger le client principal
        loadClient();
        // Charger l'intÃ©gration vidÃ©o (aprÃ¨s le client)
        setTimeout(loadVideoIntegration, 1000);
      });
    })();
  </script>
<script src="game-ui.js"></script>
</body>
</html>
